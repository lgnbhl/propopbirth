test_that("Tests for constant_model()", {
  # Prepare input ----
  temporal_dat <- tibble::tibble(
    spatial_unit = rep("Aarau", 58L),
    nat = rep(c("ch", "int"), 29),
    year = rep(2027:2055, each = 2L),
    y = c(
      0.7040489953546032, 1.7551837115451099, 0.6785455694479847,
      1.7510804095398653, 0.6658464928479255, 1.747568767962279, 0.6567887886110307,
      1.7445158411928363, 0.649692106461789, 1.7418320764950352, 0.6438710334489745,
      1.7394537463880795, 0.6389654013228838, 1.7373335880882006,
      0.6347581252860287, 1.7354354000657002, 0.631106377936542, 1.733730725021041,
      0.6279102521247006, 1.732196711743887, 0.6250966187222751, 1.7308146809387441,
      0.6226100408286568, 1.72956913089735, 0.6204073047928127, 1.7284470285861508,
      0.6184539500471592, 1.7274372919786964, 0.6167219713796117,
      1.7265304041181952, 0.615188243034145, 1.7257181201188954, 0.6138334054359574,
      1.7249932411330198, 0.6126410586451702, 1.724349437475956, 0.611597165168543,
      1.7237811084419505, 0.6106895993081887, 1.7232832699157385,
      0.6099078013584714, 1.7228514633268002, 0.6092425082935072, 1.7224816811922,
      0.608685541229371, 1.7221703056969935, 0.6082296356835472, 1.7219140576260221,
      0.607868304547607, 1.721709953591479, 0.6075957263823362, 1.7215552699663124,
      0.6074066535404073, 1.7214475122815927, 0.6072963359776233, 1.721384389108933,
      0.6072604575976803, 1.7213637896498275
    ),
    category = rep("Bezier", 58L),
  )

  expect_snapshot(constructive::construct(
    constant_model(
      in_dat = temporal_dat,
      year_start = 2065,
      year_end = 2075
    )
  ))
})
